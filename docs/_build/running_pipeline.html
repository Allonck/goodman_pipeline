

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Running the Pipeline &mdash; Goodman HTS Pipeline User Manual 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Goodman HTS Pipeline User Manual
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Running the Pipeline</a><ul>
<li><a class="reference internal" href="#working-with-virtual-environments">Working with Virtual Environments</a></li>
<li><a class="reference internal" href="#prepare-data-for-reduction">Prepare Data for Reduction</a></li>
<li><a class="reference internal" href="#run-redccd">Run redccd</a></li>
<li><a class="reference internal" href="#run-redspec">Run redspec</a></li>
<li><a class="reference internal" href="#description-of-custom-keywords">Description of custom keywords</a><ul>
<li><a class="reference internal" href="#general-purpose-keywords">General Purpose Keywords</a></li>
<li><a class="reference internal" href="#non-linear-wavelength-solution">Non-linear wavelength solution</a></li>
<li><a class="reference internal" href="#id1">Combined Images</a></li>
<li><a class="reference internal" href="#id2">Detected lines</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Goodman HTS Pipeline User Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Running the Pipeline</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/running_pipeline.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-the-pipeline">
<h1>Running the Pipeline<a class="headerlink" href="#running-the-pipeline" title="Permalink to this headline">¶</a></h1>
<p>The <a href="#id7"><span class="problematic" id="id8">|pipeline full name|</span></a> is designed to be simple to use, however help is always
necessary.</p>
<dl class="docutils">
<dt>Getting Help.</dt>
<dd><p class="first">This manual is intended to be the prefered method to get help. However the quickest option is using <code class="docutils literal"><span class="pre">-h</span></code> or <code class="docutils literal"><span class="pre">--help</span></code></p>
<p><code class="docutils literal"><span class="pre">redccd</span> <span class="pre">--help</span></code></p>
<p>Will print the list of arguments along with a quick explanation and default values.</p>
<p>It is the same for <code class="docutils literal"><span class="pre">redspec</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">redspec</span> <span class="pre">--help</span></code></p>
</dd>
</dl>
<div class="section" id="working-with-virtual-environments">
<h2>Working with Virtual Environments<a class="headerlink" href="#working-with-virtual-environments" title="Permalink to this headline">¶</a></h2>
<p>Virtual environments are a very useful tool, the main contribution of them being:</p>
<ul class="simple">
<li>Portability</li>
<li>Protection to the host environment</li>
<li>Flexibility</li>
</ul>
<p>If you know nothing about them we recommend you to start in the <a class="reference external" href="https://conda.io/docs/index.html">Conda site</a>.</p>
<p>For the purpose of this manual we will just say that a <em>Virtual Environment</em>
lets you have a custom set of libraries/tools in one place, and most importantly
is independent of your host system. Installation will not be discussed here but
you can visit <a class="reference external" href="https://conda.io/docs/user-guide/tasks/manage-environments.html">this link</a>
for information.</p>
<dl class="docutils">
<dt>Discover what environments exist in your system.</dt>
<dd><p class="first"><code class="docutils literal"><span class="pre">conda</span> <span class="pre">env</span> <span class="pre">list</span></code></p>
<p class="last">Will print a list where the first column is the name.</p>
</dd>
<dt>Activate (enter) the virtual Environment.</dt>
<dd><p class="first"><code class="docutils literal"><span class="pre">source</span> <span class="pre">activate</span> <span class="pre">&lt;venv-name&gt;</span></code></p>
<p>Where <code class="docutils literal"><span class="pre">&lt;venv-name&gt;</span></code> is the name of your virtual environment. Your shell’s
prompt will change to:</p>
<p class="last"><code class="docutils literal"><span class="pre">(&lt;venv-name&gt;)</span> <span class="pre">[user&#64;hostname</span> <span class="pre">folder-name]$</span></code></p>
</dd>
<dt>Deactivate (leave) the virtual environment.</dt>
<dd><p class="first"><code class="docutils literal"><span class="pre">source</span> <span class="pre">deactivate</span></code></p>
<p>This time the prompt will change again to:</p>
<p class="last"><code class="docutils literal"><span class="pre">[user&#64;hostname</span> <span class="pre">folder-name]$</span></code></p>
</dd>
</dl>
</div>
<div class="section" id="prepare-data-for-reduction">
<h2>Prepare Data for Reduction<a class="headerlink" href="#prepare-data-for-reduction" title="Permalink to this headline">¶</a></h2>
<p>If you did a good job preparing and doing the observation this should be an easy
step, either way, keep in mind the following steps.</p>
<ul class="simple">
<li>Remove all <em>focus</em> sequence.</li>
<li>Remove all <em>target acquisition</em> or <em>test</em> frames.</li>
<li>Using your observation’s log remove all unwanted files.</li>
<li>Make sure all data has the same gain (<code class="docutils literal"><span class="pre">GAIN</span></code>) and readout noise (<code class="docutils literal"><span class="pre">RDNOISE</span></code>)</li>
<li>Make sure all data has the same Region Of Interest or ROI (<code class="docutils literal"><span class="pre">ROI</span></code>).</li>
</ul>
<p>The pipeline does not modify the original files unless there are problems with
fits compliance, is never a bad idea to keep copies of your original data though.</p>
</div>
<div class="section" id="run-redccd">
<h2>Run redccd<a class="headerlink" href="#run-redccd" title="Permalink to this headline">¶</a></h2>
<p>It is the first step in the reduction process, the main tasks are listed below.</p>
<ul class="simple">
<li>Create master bias</li>
<li>Create master flats</li>
<li>Apply Corrections:<ul>
<li>Overscan</li>
<li>Trim image</li>
<li>Detect slit and trim out non-illuminated areas</li>
<li>Bias correction</li>
<li>Normalized flat field correction</li>
<li>Cosmic ray rejection</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="run-redspec">
<h2>Run redspec<a class="headerlink" href="#run-redspec" title="Permalink to this headline">¶</a></h2>
<p>Is the spectroscopy reduction script. The tasks are the following:</p>
<ul class="simple">
<li>Classifies data and creates the match of <code class="docutils literal"><span class="pre">OBJECT</span></code> and <code class="docutils literal"><span class="pre">COMP</span></code> if it exists.</li>
<li>Identifies targets</li>
<li>Extracts targets</li>
<li>Saves extracted targets to 1D spectrum</li>
<li>Finds wavelength solution automatically</li>
<li>Linearizes data</li>
<li>Saves wavelength calibrated file</li>
</ul>
<p>The mathematical model used to define the wavelength solution is recorded
in the header even though the data has been linearized for record purpose.</p>
</div>
<div class="section" id="description-of-custom-keywords">
<span id="new-keywords"></span><h2>Description of custom keywords<a class="headerlink" href="#description-of-custom-keywords" title="Permalink to this headline">¶</a></h2>
<p>The pipeline adds several keywords to keep track of the process and in general
for keeping important information available. The following table gives a description
of all the keywords added by <a href="#id9"><span class="problematic" id="id10">|pipeline name|</span></a>, though not all of them are
added to all the images.</p>
<div class="section" id="general-purpose-keywords">
<h3>General Purpose Keywords<a class="headerlink" href="#general-purpose-keywords" title="Permalink to this headline">¶</a></h3>
<p>These keywords are used for record purpose, except for <code class="docutils literal"><span class="pre">GSP_FNAM</span></code> which is
used to keep track of the file name.</p>
<span id="table-general-keywords"></span><table border="1" class="docutils" id="id3">
<caption><span class="caption-text">General purpose keywords, added to all images at the moment of the first read.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Purpose</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GSP_VERS</td>
<td>Pipeline version.</td>
</tr>
<tr class="row-odd"><td>GSP_ONAM</td>
<td>Original file name, first read.</td>
</tr>
<tr class="row-even"><td>GSP_PNAM</td>
<td>Parent file name.</td>
</tr>
<tr class="row-odd"><td>GSP_FNAM</td>
<td>Current file name.</td>
</tr>
<tr class="row-even"><td>GSP_PATH</td>
<td>Path from where the file was read.</td>
</tr>
<tr class="row-odd"><td>GSP_TECH</td>
<td>Observing technique. Imaging or Spectroscopy.</td>
</tr>
<tr class="row-even"><td>GSP_DATE</td>
<td>Date of processing.</td>
</tr>
<tr class="row-odd"><td>GSP_OVER</td>
<td>Overscan region.</td>
</tr>
<tr class="row-even"><td>GSP_TRIM</td>
<td>Trim section.</td>
</tr>
<tr class="row-odd"><td>GSP_SLIT</td>
<td>Slit trim section. From slit-illuminated area.</td>
</tr>
<tr class="row-even"><td>GSP_BIAS</td>
<td>Master bias file used.</td>
</tr>
<tr class="row-odd"><td>GSP_FLAT</td>
<td>Master flat file used.</td>
</tr>
<tr class="row-even"><td>GSP_NORM</td>
<td>Master flat normalization method.</td>
</tr>
<tr class="row-odd"><td>GSP_COSM</td>
<td>Cosmic ray rejection method.</td>
</tr>
<tr class="row-even"><td>GSP_WRMS</td>
<td>Wavelength solution RMS Error.</td>
</tr>
<tr class="row-odd"><td>GSP_WPOI</td>
<td>Number of points used to calculate RMS Error.</td>
</tr>
<tr class="row-even"><td>GSP_WREJ</td>
<td>Number of points rejected from RMS Error Calculation.</td>
</tr>
<tr class="row-odd"><td>GSP_DCRR</td>
<td>Reference paper for DCR software (cosmic ray rejection).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="non-linear-wavelength-solution">
<h3>Non-linear wavelength solution<a class="headerlink" href="#non-linear-wavelength-solution" title="Permalink to this headline">¶</a></h3>
<p>Since writing non-linear wavelength solutions to the headers using the FITS
standard (reference) is extremely complex and not necessarily well documented,
we came up with the solution of simply describing the mathematical model
from <code class="docutils literal"><span class="pre">astropy.modeling.models</span></code>. This allows for maintaining the data
<em>untouched</em> while keeping a reliable description of the wavelength solution.</p>
<p>The current implementation will work for writting any polinomial model. Reading is implemented only for <code class="docutils literal"><span class="pre">Chebyshev1D</span></code> which is the
model by default.</p>
<span id="table-non-linear-keywords"></span><table border="1" class="docutils" id="id4">
<caption><span class="caption-text">Keywords used to describe a non-linear wavelength solution.</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Purpose</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GSP_FUNC</td>
<td>Name of mathematical model. <code class="docutils literal"><span class="pre">astropy.modeling.models</span></code></td>
</tr>
<tr class="row-odd"><td>GSP_ORDR</td>
<td>Order of the model used.</td>
</tr>
<tr class="row-even"><td>GSP_NPIX</td>
<td>Number of pixels.</td>
</tr>
<tr class="row-odd"><td>GSP_C000</td>
<td>Value of parameter <code class="docutils literal"><span class="pre">c0</span></code>.</td>
</tr>
<tr class="row-even"><td>GSP_C001</td>
<td>Value of parameter <code class="docutils literal"><span class="pre">c1</span></code>.</td>
</tr>
<tr class="row-odd"><td>GSP_C002</td>
<td>Value of parameter <code class="docutils literal"><span class="pre">c2</span></code>. This goes on depending the order.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id1">
<h3>Combined Images<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Every image used in a combination of images is recorded in the header of the
resulting one. The order does not have importance but most likely the header
of the first one will be used</p>
<span id="table-combined-images-key"></span><table border="1" class="docutils" id="id5">
<caption><span class="caption-text">Keywords that list all the images used to produce a combined image.</span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Purpose</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GSP_IC01</td>
<td>First image used to create combined.</td>
</tr>
<tr class="row-odd"><td>GSP_IC02</td>
<td>Second image used to create combined.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id2">
<h3>Detected lines<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The <em>reference lamp library</em> maintains the lamps non-linearized and also they
get a record of the pixel value and the equivalent in angstrom. In the following
table a three-line lamp is shown.</p>
<span id="table-line-list"></span><table border="1" class="docutils" id="id6">
<caption><span class="caption-text">Description of all the keywords used to list lines in lamps in Pixel and Angstrom.</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Purpose</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GSP_P001</td>
<td>Pixel value for the first line detected.</td>
</tr>
<tr class="row-odd"><td>GSP_P002</td>
<td>Pixel value for the second line detected.</td>
</tr>
<tr class="row-even"><td>GSP_P003</td>
<td>Pixel value for the third line detected.</td>
</tr>
<tr class="row-odd"><td>GSP_A001</td>
<td>Angstrom value for the first line detected.</td>
</tr>
<tr class="row-even"><td>GSP_A002</td>
<td>Angstrom value for the second line detected.</td>
</tr>
<tr class="row-odd"><td>GSP_A003</td>
<td>Angstrom value for the third line detected.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 NOAO/AURA, Inc. All rights reserved..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>